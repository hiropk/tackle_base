<section id="blog" class="max-w-4xl mx-auto py-10 px-4">
  <h2 class="text-2xl font-bold text-center mb-1 text-gray-800">ファミリアからのお知らせ</h2>
  <div class="text-center text-gray-500 mb-8">〜 元教員の船長の日々をお届け！ 〜</div>
  <div class="text-center"><a class="text-lg font-semibold hover:underline" href="https://hiropk.github.io/familiar-sw/">ご予約はこちら💁</a></div>

  <!-- Button to open modal -->
  <button type="button" id="openScheduleModal" class="mx-auto block mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
    出船スケジュールを確認
  </button>

  <!-- Modal backdrop -->
  <div id="scheduleModalBackdrop" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40"></div>

  <!-- Modal -->
  <div id="scheduleModal" class="fixed inset-0 flex items-start justify-center pt-10 hidden z-50 overflow-y-auto">
    <div class="bg-white rounded-lg w-[95vw] max-w-[1400px] mb-10">
      <div class="flex items-center justify-between p-4 border-b sticky top-0 bg-white z-10">
        <h5 class="text-xl font-semibold">出船スケジュール</h5>
        <button type="button" id="closeScheduleModal" class="px-4 py-2 bg-red-100 hover:bg-red-200 text-red-600 hover:text-red-700 rounded-lg transition-colors">
          <span class="text-2xl font-bold">❌</span>
        </button>
      </div>
      <div class="p-4">
        <div class="iframe-container">
          <iframe
            id="iframe"
            frameborder="no"
            scrolling="yes"
            loading="lazy"
            allowfullscreen
            src="https://tsurimaru-calendar-captain.web.app/16682/?scrolling=yes"
            style="width: 100%; height: 600px;"
          ></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('scheduleModal');
      const backdrop = document.getElementById('scheduleModalBackdrop');
      const openButton = document.getElementById('openScheduleModal');
      const closeButton = document.getElementById('closeScheduleModal');

      function openModal() {
        modal.classList.remove('hidden');
        backdrop.classList.remove('hidden');
      }

      function closeModal() {
        modal.classList.add('hidden');
        backdrop.classList.add('hidden');
      }

      openButton.addEventListener('click', openModal);
      closeButton.addEventListener('click', closeModal);
      backdrop.addEventListener('click', closeModal);
    });
  </script>

  <ul class="space-y-6">
    <% @feed.entries.each do |entry| %>
      <li class="bg-white shadow-md hover:shadow-lg transition rounded-xl p-5 flex gap-4">
        <div>
          <a href="<%= entry.url %>" target="_blank" class="block">
            <h3 class="text-lg font-semibold text-blue-700 hover:underline">
              <%= entry.title %>（<%= l(entry.published.to_date, format: :short) %>）
            </h3>
            <p class="text-sm text-gray-600 mt-2">
              <%= truncate(strip_tags(entry.summary), length: 30) %>
            </p>
          </a>
        </div>
      </li>
    <% end %>
  </ul>
</section>
